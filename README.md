# Digital shadow section

This folder contains the code required to generate simulated trajectory responses to commands, using our digital shadow model. 

## Digital model structure files

The **"main_3_armpi_fpv.slx"** and **"subsystem.slx"** files contain the digital model of the arm control structure, and the arm with command input itself respectively; subsystem is designed to be used with the main file, and has been seperated for readability. **"Robot_model.slx"** contains an arm without command features, used for kinematic computations. 

## Dataset generation files

The **"multi_model_dataset_builder.m"** and **"test_main_final.m"** files are two different approaches to building a simulated dataset. The multi-model buuilder requires that a filepath to saved real motor data be provided: it then generates two cell arrays, one ("real_cell_dataset") containing the real commands and responses, resampled and processed to fit the LSTM; the other ("simulated_cell_dataset") contains simulated responses, for every failure case, to each real command. The main builder doesn't require real data, instead generating a random command (respecting resemblance constraints to the real commands), and then generates a single cell array containing simulated responses in every failure case, to each real command.

## AI training and predictions


### DTW multi-simulation evaluation

The **"multi_model_dataset_builder.m"** also serves to predict failure state, as described in the paper. Simply activating the "displays" will show trajectory-by-trajectory predictions. 

### AI training

Two training models are provided :

-**"rain_predict_lstm"**, the standard model used in our paper, which takes the provided cell array, generates labels assuming the points interate through the failure modes as generated by the above codes; and then trains a model on them.

-"substracted_inputs_lstm" is an alternate model, which usually shows worse training performance, but has performed better on some instances of real data. Instead of providing concatenated command and responses, the responses are substracted from the commands, and the LSTM is trained on the difference.

## Misc.

The **"saved_csv_pre_processor.m"** is a file which performs pre-processing on saved .csv data, before it can be used for dataset generation of evaluation. The path to the saved folder must br specified in the code body. The processing mostly serves to align command and response data, as well as removing transitional points between trajectories. Its values were heuristically selected for our specific robot and trajectory generation method, and may require adaptations to other use cases.



